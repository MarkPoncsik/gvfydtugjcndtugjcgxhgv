<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ú–∏–Ω–∏ –ö–≤–µ—Å—Ç</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #e0c3fc, #8ec5fc);
      margin: 0;
      padding: 40px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .section {
      display: none;
      width: 80%;
      max-width: 800px;
    }
    .active {
      display: block;
    }
    .text-area {
      white-space: pre-wrap;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      font-size: 16px;
      line-height: 1.6;
      overflow-y: auto;
      max-height: 300px;
      margin-bottom: 20px;
    }
    .controls, .found-words {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #7e57c2;
      color: white;
      border: none;
      cursor: pointer;
    }
    .cards {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }
    .card {
      width: 100px;
      height: 100px;
      background: #fff;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(5, 60px);
      gap: 10px;
      justify-content: center;
      margin-top: 20px;
    }
    .cell {
      width: 60px;
      height: 60px;
      background: #fff;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    #finalMessage {
      margin-top: 20px;
      font-size: 18px;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
    }
  </style>
</head>
<body>

<div class="section active" id="step1">
  <div class="text-area" id="textDisplay"></div>
  <div class="controls">
    <input type="text" id="wordInput" placeholder="–í–≤–µ–¥–∏ —Å–ª–æ–≤–æ...">
    <button onclick="submitWord()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
    <div class="found-words" id="foundSlot">–ù–∞–π–¥–µ–Ω–æ:</div>
  </div>
</div>

<div class="section" id="step2">
  <h2>–ù–∞–π–¥–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏</h2>
  <div class="cards" id="cardBoard"></div>
</div>

<div class="section" id="step3">
  <h2>–ù–∞–π–¥–∏ —Å–µ—Ä–¥–µ—á–∫–æ</h2>
  <div class="grid" id="heartGrid"></div>
</div>

<div class="section" id="final">
  <div id="finalMessage"></div>
</div>

<script>
  // –®–∞–≥ 1: –ü–æ–∏—Å–∫ —Å–ª–æ–≤
  const allWords = ["—Å–æ–ª–Ω—Ü–µ", "–ø–æ–¥–¥–µ—Ä–∂–∫–∞", "–Ω–µ–∂–Ω–æ—Å—Ç—å", "—è —Å —Ç–æ–±–æ–π", "—Ç—ã –Ω–µ –æ–¥–Ω–∞", "–¥–µ—Ä–∂–∏—Å—å", "–ª—é–±–∏–º–∞—è", "–∑–∞–±–æ—Ç–∞", "—Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ", "—Ç—ã —Å–∏–ª—å–Ω–∞—è"];
  const chosenWords = [];
  while (chosenWords.length < 1) {
    const word = allWords[Math.floor(Math.random() * allWords.length)];
    if (!chosenWords.includes(word)) chosenWords.push(word);
  }

  const symbols = "–∞–±–≤–≥–¥–µ—ë–∂–∑–∏–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—å—ã—ä—ç—é—èABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890!@#$%^&*".split("");
  const insertPoints = [100];
  let finalText = "";

  for (let i = 0; i < 400; i++) {
    if (insertPoints.includes(i)) {
      finalText += chosenWords[0].replace(/ /g, "");
    } else {
      finalText += symbols[Math.floor(Math.random() * symbols.length)];
    }
  }

  document.getElementById("textDisplay").textContent = finalText.match(/.{1,60}/g).join("\n");

  const found = [];

  function submitWord() {
    const input = document.getElementById("wordInput").value.trim().toLowerCase().replace(/ /g, "");
    const word = chosenWords[0].toLowerCase().replace(/ /g, "");

    if (input === word && !found.includes(input)) {
      found.push(input);
      document.getElementById("foundSlot").textContent += `\n${chosenWords[0]}`;
      goToStep(2);
      initCards();
    } else {
      alert("–ü–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥–æ–µ —Å–ª–æ–≤–æ.");
    }
    document.getElementById("wordInput").value = "";
  }

  // –®–∞–≥ 2: –ö–∞—Ä—Ç–æ—á–∫–∏
  const emojis = ["‚ù§Ô∏è", "‚≠ê", "üåô", "‚òÄÔ∏è", "‚ú®", "‚ù§Ô∏è", "‚≠ê", "üåô", "‚òÄÔ∏è", "‚ú®"];
  let opened = [];

  function initCards() {
    const board = document.getElementById("cardBoard");
    board.innerHTML = "";
    const shuffled = [...emojis].sort(() => 0.5 - Math.random());
    shuffled.forEach((emoji, i) => {
      const div = document.createElement("div");
      div.className = "card";
      div.dataset.emoji = emoji;
      div.onclick = () => flipCard(div);
      board.appendChild(div);
    });
  }

  function flipCard(card) {
    if (opened.length < 2 && !card.textContent) {
      card.textContent = card.dataset.emoji;
      opened.push(card);
      if (opened.length === 2) {
        setTimeout(() => {
          if (opened[0].dataset.emoji === opened[1].dataset.emoji) {
            opened = [];
            if ([...document.querySelectorAll(".card")].every(c => c.textContent)) {
              goToStep(3);
              initHeart();
            }
          } else {
            opened.forEach(c => c.textContent = "");
            opened = [];
          }
        }, 600);
      }
    }
  }

  // –®–∞–≥ 3: –°–µ—Ä–¥–µ—á–∫–æ
  function initHeart() {
    const grid = document.getElementById("heartGrid");
    grid.innerHTML = "";
    const cells = [];
    for (let i = 0; i < 25; i++) {
      const cell = document.createElement("div");
      cell.className = "cell";
      cell.onclick = () => checkHeart(cell, i === 12);
      cells.push(cell);
      grid.appendChild(cell);
    }
  }

  function checkHeart(cell, isHeart) {
    if (isHeart) {
      cell.textContent = "‚ù§Ô∏è";
      showFinal();
    } else {
      cell.textContent = "‚úñ";
      cell.style.pointerEvents = "none";
    }
  }

  // –§–∏–Ω–∞–ª
  function showFinal() {
    goToStep("final");
    const word = chosenWords[0];
    const msg = `–¢—ã –º–æ—ë <b>${word}</b>. –Ø —Ç–µ–±—è –ø–æ–¥–¥–µ—Ä–∂—É –≤—Å–µ–≥–¥–∞. –Ø —Ü–µ–Ω—é —Ç–µ–±—è –∏ —Ö–æ—á—É –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Å —Ç–æ–±–æ–π –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏. –ù–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π ‚Äî –º—ã —Å–ø—Ä–∞–≤–∏–º—Å—è —Å–æ –≤—Å–µ–º–∏ —Ç—Ä—É–¥–Ω–æ—Å—Ç—è–º–∏.`;
    document.getElementById("finalMessage").innerHTML = msg;
  }

  function goToStep(n) {
    document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
    document.getElementById("step" + n).classList.add("active");
  }
</script>

</body>
</html>

